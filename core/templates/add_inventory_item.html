{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="pt-20">
  <main class="container mx-auto px-4 py-8" id="main-content">
    <div class="mb-8" id="page-header">
      <div class="flex items-center space-x-4 mb-4">
        <a class="text-gray-400 hover:text-yellow-500" href="{% url 'inventory_dashboard' %}">
          <i class="fa-solid fa-arrow-left text-xl"></i>
        </a>
        <h1 class="text-3xl font-bold aurebesh text-yellow-500 text-glow">
          {% if form.instance.pk %}EDIT ITEM{% else %}ADD NEW ITEM TO INVENTORY{% endif %}
        </h1>
      </div>
      <p class="text-gray-400">
        {% if form.instance.pk %}
          Update the details of your galactic collectible
        {% else %}
          Enter detailed information about the new product to add to your galactic collection
        {% endif %}
      </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="lg:col-span-2">
        <form method="post" enctype="multipart/form-data" class="space-y-6" id="add-item-form">
          {% csrf_token %}

          <!-- BASIC INFO -->
          <div class="datapad p-6 rounded-lg" id="basic-info">
            <h3 class="text-xl font-bold aurebesh text-yellow-500 mb-6 flex items-center">
              <i class="fa-solid fa-info-circle mr-2"></i>
              BASIC INFORMATION
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  Item Name *
                </label>
                {{ form.name }}
                {{ form.name.errors }}
              </div>
              <div>
                <label for="{{ form.sku.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  SKU
                </label>
                {{ form.sku }}
                {{ form.sku.errors }}
              </div>
            </div>
            <div class="mt-6">
              <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                Description
              </label>
              {{ form.description }}
              {{ form.description.errors }}
            </div>
          </div>

          <!-- PRODUCT DETAILS -->
          <div class="datapad p-6 rounded-lg" id="product-details">
            <h3 class="text-xl font-bold aurebesh text-yellow-500 mb-6 flex items-center">
              <i class="fa-solid fa-cog mr-2"></i>
              PRODUCT DETAILS
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div>
                <label for="{{ form.category.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  Category *
                </label>
                {{ form.category }}
                {{ form.category.errors }}
              </div>
              <div>
                <label for="{{ form.price.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  Price ($) *
                </label>
                {{ form.price }}
                {{ form.price.errors }}
              </div>
              <div>
                <label for="{{ form.quantity.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  Quantity in Stock *
                </label>
                {{ form.quantity }}
                {{ form.quantity.errors }}
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
              <div>
                <label class="block text-sm font-medium text-gray-300 mb-2">Condition</label>
                {{ form.condition }}
                {{ form.condition.errors }}
              </div>
              <div>
                <label for="{{ form.availability_status.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                  Availability Status
                </label>
                {{ form.availability_status }}
                {{ form.availability_status.errors }}
              </div>
            </div>
          </div>

          <!-- IMAGE UPLOAD -->
          <div class="datapad p-6 rounded-lg" id="image-upload">
            <h3 class="text-xl font-bold aurebesh text-yellow-500 mb-6 flex items-center">
              <i class="fa-solid fa-image mr-2"></i>
              PRODUCT IMAGE
            </h3>
            {{ form.image_url }}
            {{ form.image_url.errors }}
          </div>

          <!-- ADDITIONAL OPTIONS -->
          <div class="datapad p-6 rounded-lg" id="additional-options">
            <h3 class="text-xl font-bold aurebesh text-yellow-500 mb-6 flex items-center">
              <i class="fa-solid fa-plus-circle mr-2"></i>
              ADDITIONAL OPTIONS
            </h3>
            <div>
              <label for="{{ form.tags.id_for_label }}" class="block text-sm font-medium text-gray-300 mb-2">
                Tags (Optional)
              </label>
              {{ form.tags }}
              {{ form.tags.errors }}
            </div>
          </div>

          <!-- FORM ACTIONS -->
          <div class="flex flex-col sm:flex-row gap-4 justify-end" id="form-actions">
            <a href="{% url 'inventory_dashboard' %}"
               class="px-6 py-3 text-gray-400 hover:text-gray-300 border border-gray-600 rounded-lg">
              Cancel
            </a>
            <button type="submit"
                    class="px-8 py-3 bg-yellow-600 hover:bg-yellow-500 text-black rounded-lg font-medium">
              <i class="fa-solid fa-rocket mr-2"></i>
              {% if form.instance.pk %}UPDATE ITEM{% else %}SAVE ITEM{% endif %}
            </button>
          </div>
        </form>
      </div>

      <!-- PREVIEW PANEL (unchanged) -->
      <div class="lg:col-span-1">
        <!-- ... your existing preview markup ... -->
      </div>
    </div>
  </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('add-item-form');
  form.addEventListener('submit', function(e) {
    // Let Django handle the POST
  });
});
</script>
{% endblock %}
